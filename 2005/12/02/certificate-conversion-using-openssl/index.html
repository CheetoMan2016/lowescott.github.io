<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Certificate Conversion Using OpenSSL &middot; Scott&#39;s Weblog
    
  </title>

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item " href="/post">Posts</a>

    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a class="sidebar-nav-item " href="http://lowescott.github.io/about/">About</a>
      
    
      
        <a class="sidebar-nav-item " href="http://lowescott.github.io/learning-nvp-nsx/">Learning NVP/NSX</a>
      
    

    <a class="sidebar-nav-item" href="https://github.com/lowescott.zip">My GitHub</a>
    <a class="sidebar-nav-item" href="https://twitter.com/scott_lowe">My Twitter</a>
  </nav>

  <div class="sidebar-item">
    <p>&copy; 2014. Unless otherwise noted, all content on this site is licensed under a <a href="http://creativecommons.org/licenses/by-sa/3.0/us/">Creative Commons Attribution-Share Alike 3.0 United States License</a>.</p>
    
    <p><img alt="Creative Commons License" src="/assets/cc-by-sa.png" /></p>
  </div>
</div>


    
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Scott&#39;s Weblog</a>
            <small>The weblog of an IT pro specializing in virtualization, networking, cloud computing, &amp; Macs</small>
          </h3>
        </div>
      </div>

      <div class="container content">


<div class="post">
  <h1 class="post-title">Certificate Conversion Using OpenSSL</h1>
  <span class="post-date">Dec 2, 2005 4:08 PM</span>
  <p>In my various adventures with replacing Windows-based servers with Linux servers, I have had need on several occasions to take an SSL certificate (generated using Microsoft Certificate Services) and make it available to a Linux-based server. In some cases, it was to be used by the SSL wrapper <a href="http://stunnel.mirt.net/index.html">Stunnel</a>; in others, it was for <a href="http://www.apache.org/httpd/">Apache</a>.</p>

<p>In either case, the certificate needed to be in the PEM (originally Privacy Enhanced Mail, now a standard for encoding certificates) format. Windows, on the other hand, typically uses the PFX (PKCS #12) format for storing certificates. To prepare certificates for use on Linux, the certificates must be converted to PEM format.</p>

<p>In the hopes that this information might be useful to others, here&rsquo;s a process for converting from PFX to PEM using <a href="http://www.openssl.org/">OpenSSL</a>. With the exception of only a few items, the process is identical on Linux, <a href="http://www.apple.com/macosx/">Mac OS X</a>, and <a href="http://www.microsoft.com/windowsserver2003/default.mspx">Windows <sup>2000</sup>&frasl;<sub>2003</sub></a>. These steps were confirmed using OpenSSL 0.9.7a on Red Hat Linux 9.0, using OpenSSL 0.9.6i on Mac OS X 10.2.8, and OpenSSL 0.9.7c on Windows Server 2003.</p>

<ol>
<li><p>If the certificate is not already available in PFX format, use the Certificates MMC snap-in to export the certificate and the corresponding private key to a PFX file. Be sure to note the passphrase used to protect the PFX file; it will be needed later. If the certificate (and its corresponding private key) is already available in PFX format and the passphrase for the PFX file is known, proceed to step 2.</p></li>

<li><p>At a terminal prompt, type <code>openssl pkcs12 -in _pfxfilename.pfx_ -out _tempfile.pem_</code>. This will convert the PFX file to a PEM file. The OpenSSL toolkit will prompt for the import passphrase; this will be the passphrase specified in step 1. A PEM passphrase will also be needed; make note of the passphrase used here (it will be needed later).</p></li>

<li><p>Using a text editor (such as vi on a Linux system, or Notepad on a Windows system), split the encrypted RSA private key and the certificate into two separate files. Remove all extra text, leaving only the text between the lines with the dashes. Make note of the filenames; they will be needed later.</p></li>

<li><p>The RSA key is currently encrypted; this will an automated launch for the application using the certificate. It will be necessary to decrypt the RSA private key. To decrypt the RSA private key, use the command <code>openssl rsa -in _encryptedkey_ -out _decryptedkey_</code> (where <em>encryptedkey</em> is the file containing the RSA private key, as separated in step 3, and <em>decryptedkey</em> is the file that will contain the decrypted RSA private key). The OpenSSL toolkit will prompt for the RSA key passphrase; this will be the passphrase specified in step 2.</p></li>

<li><p>On Linux or Mac OS X: To concatenate the decrypted RSA private key and the certificate into a single file, use the command <code>cat _decryptedkey certificatefile_ &gt; _finalfile.pem_</code> (where <em>decryptedkey</em> is the decrypted RSA key produced in step 4 and <em>certificatefile</em> is the file containing only the certificate, as produced in step 3).</p></li>

<li><p>On Windows: To combine the decrypted RSA private key and the certificate into a single file, use the command <code>copy /b _decryptedkey_+_certificatefile_ _finalfile.pem_</code> (where <em>decryptedkey</em> is the decrypted RSA key produced in step 4 and <em>certificatefile</em> is the file containing only the certificate, as produced in step 3).</p></li>

<li><p>Edit the concatenated file (finalfile.pem from step 5) with a text editor to add a blank line between the decrypted RSA private key and the certificate, and a blank line after the end of the certificate.</p></li>
</ol>

<p>At this point, the certificate is ready for use. <strong><em>Be sure</em></strong> to guard the unencrypted private key with extreme caution; loss of this file can result in the compromise of your system. Note also that most applications require that the certificates be owned by root and readable only by root (<code>chown root:root</code> to make them owned by root and <code>chmod 600</code> to make them readable only by root).</p>

</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>

