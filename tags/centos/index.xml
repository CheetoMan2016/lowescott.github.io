<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Scott&#39;s Weblog </title>
    <link>http://lowescott.github.io/tags/centos/index.xml/</link>
    <language>en-us</language>
    <author>Scott Lowe</author>
    <rights>(C) 2005</rights>
    <updated>2005-12-23 14:50:45 &#43;0000 &#43;0000</updated>

    
      
        <item>
          <title>CentOS NTPd Problem (Mostly) Resolved</title>
          <link>http://lowescott.github.io/2005/12/23/centos-ntpd-problem-mostly-resolved/</link>
          <pubDate>Fri, 23 Dec 2005 14:50:45 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/12/23/centos-ntpd-problem-mostly-resolved/</guid>
          <description>&lt;p&gt;The NTPd problem that I &lt;a href=&#34;http://blog.scottlowe.org/2005/08/16/strange-ntpd-problem-on-centos-41/&#34;&gt;wrestled with in CentOS 4.1&lt;/a&gt; and &lt;a href=&#34;http://blog.scottlowe.org/2005/12/19/ntpd-on-centos-42/&#34;&gt;again in CentOS 4.2&lt;/a&gt; has finally been resolved. Mostly. I think. The specific steps I took to resolve the issue came from a number of sources, so read on for all the details.&lt;/p&gt;

&lt;p&gt;Since these servers are virtual servers running under &lt;a href=&#34;http://www.vmware.com/&#34;&gt;VMware&lt;/a&gt;, I first consulted the VMware Knowledge Base and turned up this article on &lt;a href=&#34;http://www.vmware.com/support/kb/enduser/std_adp.php?p_sid=Nuh3rAXh&amp;amp;p_lva=&amp;amp;p_faqid=1420&amp;amp;p_created=1093994398&amp;amp;p_sp=cF9zcmNoPTEmcF9ncmlkc29ydD0mcF9yb3dfY250PTc0MyZwX3NlYXJjaF90ZXh0PUxpbnV4IGd1ZXN0IGNsb2NrJnBfc2VhcmNoX3R5cGU9NyZwX3Byb2RfbHZsMT1_YW55fiZwX3Byb2RfbHZsMj1_YW55fiZwX3NvcnRfYnk9ZGZsdCZwX3BhZ2U9MQ**&amp;amp;p_li=&#34;&gt;slow and fast clocks for Linux guest VMs&lt;/a&gt;. Based on that information, I added a few extra commands to the grub configuration:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;noapic nosmp nolapic clock=pit
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In addition, I found a number of forum postings in various sites (too many to list or link here) that referenced problems with NTP and ACPI. So, based on that information, I further edited the grub configuration to look like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;noapic nosmp nolapic clock=pit acpi=no
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Finally, based on information regarding NTP itself and the NTP configuration parameters, I added the &amp;ldquo;burst iburst&amp;rdquo; parameters to the server lines in my &lt;code&gt;ntp.conf&lt;/code&gt; file, like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;server W.X.Y.Z burst iburst
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This helped, as at least now NTP would synchronize against something other than the local clock (which was more than it had done previously). For some reason, though, the &lt;code&gt;/var/log/messages&lt;/code&gt; log file was filling up with messages about synchronizing against the local clock, then synchronizing against the server, then against the local clock, etc. (You get the picture.)&lt;/p&gt;

&lt;p&gt;Given that I was synchronizing against a &lt;a href=&#34;http://www.microsoft.com/windowsserver2003/default.mspx&#34;&gt;Windows Server 2003&lt;/a&gt;-based computer, I thought perhaps that Microsoft&amp;rsquo;s NTP implementation was simply broken. (This certainly wouldn&amp;rsquo;t be the first time.) So I configured &lt;a href=&#34;http://www.openntpd.org/&#34;&gt;OpenNTPd&lt;/a&gt; on an &lt;a href=&#34;http://www.openbsd.org/&#34;&gt;OpenBSD&lt;/a&gt; server (running OpenBSD 3.8) and re-configured the CentOS server to synchronize against the OpenBSD NTP server.&lt;/p&gt;

&lt;aside&gt;OpenNTPd is ridiculously simple to configure and operate, and _just works._&lt;/aside&gt;

&lt;p&gt;The repetitive synchronization messages still appeared, but were appearing with far less frequency. And the time still isn&amp;rsquo;t synchronized to the level I would like, but it does stay within a minute or so of the rest of the network (well within the 5 minute gap required in order for Kerberos authentication to work).&lt;/p&gt;

&lt;p&gt;So, it&amp;rsquo;s still not working as cleanly as the older Red Hat Linux 9.0-based servers, but it &lt;em&gt;is&lt;/em&gt; working. Given that I&amp;rsquo;m still running these servers under an old version of VMware (which, technically, doesn&amp;rsquo;t support Linux 2.6 kernels) I may try upgrading to a new version of VMware to see if that helps at all.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>NTPd on CentOS 4.2</title>
          <link>http://lowescott.github.io/2005/12/19/ntpd-on-centos-42/</link>
          <pubDate>Mon, 19 Dec 2005 16:08:20 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/12/19/ntpd-on-centos-42/</guid>
          <description>&lt;p&gt;A while back, I started working with &lt;a href=&#34;http://www.centos.org/&#34;&gt;CentOS&lt;/a&gt; (version 4.1 at the time, see my &lt;a href=&#34;http://blog.scottlowe.org/2005/08/08/brief-impressions-of-centos-41/&#34;&gt;impressions&lt;/a&gt; here) as a candidate replacement for the Red Hat Linux 9.0-based servers still in service on the network. Although I was (and still am) very comfortable with Red Hat Linux 9.0, it&amp;rsquo;s getting a bit long in the tooth and I wanted to update the servers to a more modern software base.&lt;/p&gt;

&lt;p&gt;The problem is, I kept running into &lt;a href=&#34;http://blog.scottlowe.org/2005/08/16/strange-ntpd-problem-on-centos-41/&#34;&gt;issues with time synchronization&lt;/a&gt; on the CentOS server. This time synchronization issue did &lt;em&gt;not&lt;/em&gt; appear on the Red Hat Linux servers. I tried to resolve the issue, but never did find the solution. Instead, I just used ntpdate in a cron job. That seemed to work well enough, but I really wanted it to work PROPERLY.&lt;/p&gt;

&lt;p&gt;So I started working with CentOS 4.2 earlier this week, hoping that whatever had plagued me with the previous version wouldn&amp;rsquo;t afflict me this time. Unfortunately, the exact same problem has cropped up again, and I am at a loss trying to figure out why it doesn&amp;rsquo;t work. The output from &lt;code&gt;ntpq -p&lt;/code&gt; indicates that communication is occurring with the desired time servers, but the NTP daemon still keeps choosing to synchronize with the local clock. SELinux is disabled, so it can&amp;rsquo;t be interfering with NTP (I think that was the problem with the earlier CentOS 4.1 installation), &lt;code&gt;iptables&lt;/code&gt; is not running (so it can&amp;rsquo;t be a firewall issue), file permissions and ownership look OK&amp;mdash;what could I be missing? If anyone has any ideas, please let me know.&lt;/p&gt;
</description>
        </item>
      
    

  </channel>
</rss>
