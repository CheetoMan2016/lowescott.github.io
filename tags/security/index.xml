<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Scott&#39;s Weblog </title>
    <link>http://lowescott.github.io/tags/security/index.xml/</link>
    <language>en-us</language>
    <author>Scott Lowe</author>
    <rights>(C) 2005</rights>
    <updated>2005-12-29 21:47:21 &#43;0000 &#43;0000</updated>

    
      
        <item>
          <title>WMF Flaw Exploit Grows Worse</title>
          <link>http://lowescott.github.io/2005/12/29/wmf-flaw-exploit-grows-worse/</link>
          <pubDate>Thu, 29 Dec 2005 21:47:21 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/12/29/wmf-flaw-exploit-grows-worse/</guid>
          <description>&lt;p&gt;In an update to my previous article on the &lt;a href=&#34;http://blog.scottlowe.org/2005/12/28/windows-metafile-flaw-already-being-exploited/&#34;&gt;Windows Metafile flaw&lt;/a&gt;, new reports are coming in of greater use of malicious WMF files that take advantage of the flaw, especially by adware companies. Numerous sites are reporting that malicious WMF files are being used in ad rotations on third-party sites. For more information, see one of the following articles:&lt;/p&gt;

&lt;p&gt;Analysts Fret as Adware Makers Leverage WMF Flaw
&lt;a href=&#34;http://www.eweek.com/article2/0,1759,1906915,00.asp&#34;&gt;http://www.eweek.com/article2/0,1759,1906915,00.asp&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Critical Impact: Windows Metafile Flaw a &amp;lsquo;Zero-Day Exploit&amp;rsquo;
&lt;a href=&#34;http://www.eweek.com/article2/0,1759,1906177,00.asp&#34;&gt;http://www.eweek.com/article2/0,1759,1906177,00.asp&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In addition, there are details on just how easy it is to &lt;a href=&#34;http://www.oreillynet.com/pub/wlg/8879?CMP=OTC-6YE827253101&amp;amp;ATT=Exploiting+the+Windows+XP/2003+Picture+and+Fax+Viewer+Metafile+Overflow+Vulnerability&#34;&gt;take advantage of this vulnerability&lt;/a&gt; available as well.&lt;/p&gt;

&lt;p&gt;The particularly bad part of this whole situation is that users don&amp;rsquo;t have to do a thing&amp;mdash;just visiting a web site with a malicious WMF file can affect your system. And this isn&amp;rsquo;t an Internet Explorer flaw, either, lest you think that using Firefox will keep you safe. No, this is a &lt;em&gt;Windows&lt;/em&gt; flaw, and Internet Explorer, Firefox, Opera, etc., are all affected.&lt;/p&gt;

&lt;p&gt;Let&amp;rsquo;s hope that a good workaround (not unregistering the shimgvw.dll file, which also disables previewing other image formats in Windows Explorer) emerges soon.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Windows Metafile Flaw Already Being Exploited</title>
          <link>http://lowescott.github.io/2005/12/28/windows-metafile-flaw-already-being-exploited/</link>
          <pubDate>Wed, 28 Dec 2005 16:33:13 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/12/28/windows-metafile-flaw-already-being-exploited/</guid>
          <description>&lt;p&gt;Two separate reports (&lt;a href=&#34;http://www.eweek.com/article2/0,1759,1906177,00.asp&#34;&gt;this article from eWeek&lt;/a&gt; and &lt;a href=&#34;http://www.computerworld.com/securitytopics/security/story/0,10801,107375,00.html&#34;&gt;this article from ComputerWorld&lt;/a&gt;) have risen today regarding a &amp;ldquo;zero-day&amp;rdquo; exploit of a vulnerability in Windows&amp;rsquo; handling of WMF (Windows Metafile) images. According to the reports, simply viewing a WMF file (such as from a web site) can infect your computer. Sunbelt Software&amp;rsquo;s blog also offers &lt;a href=&#34;http://sunbeltblog.blogspot.com/2005/12/new-exploit-blows-by-fully-patched.html&#34;&gt;more details on the vulnerability&lt;/a&gt; as well. Here&amp;rsquo;s &lt;a href=&#34;http://www.securityfocus.com/bid/16074/info&#34;&gt;more information&lt;/a&gt; from SecurityFocus as well.&lt;/p&gt;

&lt;p&gt;According to the reports, this newly discovered WMF vulnerability will allow crackers to run the code of their choice on the affected system(s). So far, the exploit has been limited to installing spyware, adware, and keyloggers, but there is little doubt in anyone&amp;rsquo;s mind that the attackers will grow much worse very quickly. The vulnerability can be exploited in a variety of ways, such as visiting hostile web sites (using either Internet Explorer, Opera, or Firefox); opening an affected WMF file in Windows Picture and Fax Viewer; or previewing an affected file in Windows Explorer. It&amp;rsquo;s important to note that this vulnerability affects even fully patched systems &lt;em&gt;with all available patches installed.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Apparently, the only workaround is to uninstall Windows from your computer and immediately install Linux. OK, just kidding. Seriously, though, the only known workaround at this time is to unregister the affected DLL using this command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;regsvr32 /u shimgvw.dll
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Click &amp;ldquo;OK&amp;rdquo; when prompted. This unregisters the affected DLL and eliminates the vulnerability; however, this may also affect the viewing and previewing of many other types of images.&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s still early yet in the discovery process, so I fully anticipate that more workarounds and more information will emerge as the security researchers continue their work.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Security Flaw Found in VMware</title>
          <link>http://lowescott.github.io/2005/12/26/security-flaw-found-in-vmware/</link>
          <pubDate>Mon, 26 Dec 2005 21:45:32 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/12/26/security-flaw-found-in-vmware/</guid>
          <description>&lt;p&gt;Just so the Windows flaws don&amp;rsquo;t get all the attention, here&amp;rsquo;s a reasonably new one: a flaw in &lt;a href=&#34;http://www.vmware.com/&#34;&gt;VMware&lt;/a&gt;, the machine virtualization software that is tremendously popular, especially among security professionals. Fortunately, it&amp;rsquo;s reasonably easy to work around the flaw, and VMware has already released a patch.&lt;/p&gt;

&lt;p&gt;This link offers more details on the &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1904647,00.asp&#34;&gt;VMware security flaw&lt;/a&gt;, which apparently affects almost all of the VMware products, with the notable exception of ESX Server. VMware&amp;rsquo;s &lt;a href=&#34;http://www.vmware.com/support/kb/enduser/std_adp.php?p_faqid=2000&#34;&gt;security advisory&lt;/a&gt; also provides complete details and information on how to protect against it, plus a link to download the patch.&lt;/p&gt;

&lt;p&gt;VMware users can sidestep the security issue by not using NAT networking for their virtual machines, as pointed out in the security advisory.&lt;/p&gt;

&lt;p&gt;While security flaws in Microsoft&amp;rsquo;s Windows operating system and Internet Explorer web browser get most of the attention these days, all products have them. Users of Linux or &lt;a href=&#34;http://www.apple.com/macosx/&#34;&gt;Mac OS X&lt;/a&gt; like to proclaim their immunity, but no one is immune. This recent vulnerability merely highlights the fact that we must all be vigilant and watchful in order to maintain the security and integrity of our networks and systems.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Application-Specific VPNs</title>
          <link>http://lowescott.github.io/2005/12/13/application-specific-vpns/</link>
          <pubDate>Tue, 13 Dec 2005 11:18:37 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/12/13/application-specific-vpns/</guid>
          <description>

&lt;p&gt;I coined the term &amp;ldquo;application specific VPNs&amp;rdquo; as I began exploring the many uses of tools such as SSH (the &lt;a href=&#34;http://www.openssh.org/&#34;&gt;OpenSSH&lt;/a&gt; implementation, in particular) and &lt;a href=&#34;http://stunnel.mirt.net/index.html&#34;&gt;Stunnel&lt;/a&gt; (the open source &lt;a href=&#34;http://en.wikipedia.org/wiki/Secure_Sockets_Layer&#34;&gt;SSL&lt;/a&gt; wrapper). An &amp;ldquo;application specific VPN&amp;rdquo; is a technique for employing encrypted communication with a particular remote application that does not affect the operation of other applications (local or remote) on the system.&lt;/p&gt;

&lt;p&gt;In general, most VPNs employ technology such as &lt;a href=&#34;http://en.wikipedia.org/wiki/PPTP&#34;&gt;PPTP&lt;/a&gt; or &lt;a href=&#34;http://en.wikipedia.org/wiki/Ipsec&#34;&gt;IPSec&lt;/a&gt;. These protocols usually affect &lt;em&gt;all&lt;/em&gt; traffic originating from that system (unless we use split tunneling). With an application specific VPN, only particular types of traffic are affected, and these particular types of traffic are wrapped in an encrypted SSH or SSL tunnel using either OpenSSH or Stunnel, respectively. Other types of traffic are unaffected.&lt;/p&gt;

&lt;p&gt;While this may seem old hat to long-time Linux, Unix, or &lt;a href=&#34;http://www.apple.com/macosx/&#34;&gt;Mac OS X&lt;/a&gt; users, this is a relatively new concept to other platforms. Being a (fairly) new convert to Mac OS X myself, I found myself enjoying the tremendous flexibility offered by application specific VPNs. However, this functionality is certainly not limited to these platforms, and it is possible for &lt;a href=&#34;http://www.microsoft.com/windows/&#34;&gt;Windows&lt;/a&gt; users to utilize this functionality as well.&lt;/p&gt;

&lt;h3 id=&#34;toc_0&#34;&gt;Some Examples&lt;/h3&gt;

&lt;p&gt;Here are a few examples of how you can use application specific VPNs:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://www.citrix.com/English/ps2/products/product.asp?contentID=186&amp;amp;ntref=PROHOME_Main&#34;&gt;Citrix Presentation Server&lt;/a&gt;: Users can wrap Citrix ICA traffic in SSL using Stunnel; this avoids the need to pay for commercial solutions (although, quite honestly, the commercial solutions are typically easier to deploy and manage).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;E-Mail: Lots of people talk about securing e-mail, but not usually in the context of securing client-to-server traffic. With Stunnel, you can add SSL support for IMAP, POP, and/or SMTP even if the server doesn&amp;rsquo;t support SSL natively. In fact, you can add Stunnel to &lt;a href=&#34;http://www.microsoft.com/exchange/default.mspx&#34;&gt;Microsoft Exchange&lt;/a&gt; to help bolster that product&amp;rsquo;s built-in support for SSL (such as using SMTPS instead of STARTTLS for encrypting SMTP traffic).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Remote Desktop: This is a great technique for sysadmins. Need to use Remote Desktop to manage a Windows-based server remotely, but don&amp;rsquo;t want to run into security problems? Use Stunnel or OpenSSH to encrypt the RDP traffic. Stunnel, in my opinion, is particularly good here, since it&amp;rsquo;s incredibly easy to use the Windows port of Stunnel to establish an SSL listener on an arbitrary high port for this very purpose.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;toc_1&#34;&gt;Using Stunnel for SSL-based Application Specific VPNs&lt;/h3&gt;

&lt;p&gt;On Windows, there is no graphical user interface (GUI) for configuring Stunnel; all configuration must be done with the &lt;code&gt;stunnel.conf&lt;/code&gt; configuration file. A sample &lt;code&gt;stunnel.conf&lt;/code&gt; file is found below; this file listens on TCP port 1494 and forwards traffic to TCP port 3389 on the same system. (Note that this would be a sample &lt;code&gt;stunnel.conf&lt;/code&gt; file for a server-side configuration.)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;CApath = c:\windows\system32\stunnel  
cert = c:\windows\system32\stunnel\stunnel.pem  
client = no  
service = SSLTunnel  
[rdp]  
accept = 1494  
connect = 3389
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once Stunnel has been configured, running &lt;code&gt;stunnel --install&lt;/code&gt; will install it as a system service; this service can then be stopped and started through the Services MMC console just like any other background service.&lt;/p&gt;

&lt;p&gt;Of course, this is only half the work; you&amp;rsquo;ll also need an equivalent Stunnel configuration on the client side, since the Microsoft RDP client (the &lt;a href=&#34;http://www.microsoft.com/downloads/details.aspx?FamilyID=80111f21-d48d-426e-96c2-08aa2bd23a49&amp;amp;DisplayLang=en&#34;&gt;Windows version&lt;/a&gt; or the &lt;a href=&#34;http://www.microsoft.com/mac/otherproducts/otherproducts.aspx?pid=remotedesktopclient&#34;&gt;Mac OS X&lt;/a&gt; version) does not support SSL. Also, note that the SSL certificate used by Stunnel needs to be in PEM format (which is a nice lead-in to my article discussing the &lt;a href=&#34;http://blog.scottlowe.org/2005/12/02/certificate-conversion-using-openssl/&#34;&gt;conversion of certificates&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;On Mac OS X, there is a graphical utility for managing Stunnel called SSL Enabler. (Note that I was not able to find a home page for this utility; downloads can be found at various sites.)&lt;/p&gt;

&lt;p&gt;On Linux, the configuration again involves editing the &lt;code&gt;stunnel.conf&lt;/code&gt; file and launching stunnel (either in the foreground or as a daemon). I&amp;rsquo;m not aware of any GUI utilities for configuring Stunnel on Linux, but that certainly doesn&amp;rsquo;t mean they don&amp;rsquo;t exist.&lt;/p&gt;

&lt;h3 id=&#34;toc_2&#34;&gt;Using SSH for Application Specific VPNs&lt;/h3&gt;

&lt;p&gt;As with Stunnel, it&amp;rsquo;s also possible to use SSH to create application specific VPNs. Mac OS X comes with OpenSSH, as do most distributions of Linux and various flavors of BSD. Windows users can also find various ports of OpenSSH and utilities such as &lt;a href=&#34;http://www.chiark.greenend.org.uk/~sgtatham/putty/&#34;&gt;PuTTY&lt;/a&gt; that make it possible to use SSH for application specific VPNs as well.&lt;/p&gt;

&lt;p&gt;On Mac OS X, the following command in Terminal will create an application specific VPN to encrypt IMAP traffic to a remote server:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ssh -L 1143:imapserver.domain.com:143 -N -f user@sshserver.domain.com
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This same technique could be used to encrypt WebDAV traffic to a remote web server, other types of mail traffic (POP3 or SMTP, for example), RDP (for Remote Desktop), etc. Note that it doesn&amp;rsquo;t work well with HTTP traffic that requires the use of host headers.&lt;/p&gt;

&lt;p&gt;There are a few graphical utilities on Mac OS X for managing SSH tunnels; these include &lt;a href=&#34;http://projects.tynsoe.org/en/stm/&#34;&gt;SSH Tunnel Manager&lt;/a&gt; and &lt;a href=&#34;http://www.leapingbytes.com/almostvpn&#34;&gt;AlmostVPN&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Not being a regular day-to-day Linux user (not on the desktop, at least), I don&amp;rsquo;t know of any SSH tunnel management applications, but I would be very surprised if they didn&amp;rsquo;t exist.&lt;/p&gt;

&lt;h3 id=&#34;toc_3&#34;&gt;Creating Site-to-Site Application Specific VPNs&lt;/h3&gt;

&lt;p&gt;Most of the examples so far have been using SSH and/or Stunnel to connect endpoints (i.e., a single laptop or desktop computer) to a remote resource via an application specific VPN. However, it&amp;rsquo;s also easily possible to create application specific site-to-site VPNs, whose purpose is to secure only a particular type of traffic between two locations.&lt;/p&gt;

&lt;p&gt;Consider this example. CompanyA wants to send e-mail to CompanyB, but wants that e-mail to be secure. If both mail servers support TLS, then the organizations could use TLS to secure the SMTP traffic. If not, then the companies can use Stunnel to establish an SSL connection between two systems. HostA at CompanyA can use Stunnel as a client side application to listen for unencrypted connections and pass them as encrypted connections to HostB at CompanyB. HostB at CompanyB is using Stunnel to listen for encrypted connections and passes them unencrypted to the mail server at CompanyB. With a simple configuration, the mail servers at both companies can be configured to pass mail connections for other company through the Stunnel connection. With no additional cost and very little configuration, all e-mail traffic between the two organizations has now been secured. All this without the complexity of a typical B-to-B VPN and the associated access controls.&lt;/p&gt;

&lt;p&gt;For more information, documents on &lt;a href=&#34;http://blog.scottlowe.org/downloads/ptd-asvpn-ssh.doc&#34;&gt;application specific VPNs with SSH&lt;/a&gt; and &lt;a href=&#34;http://blog.scottlowe.org/downloads/ptd-asvpn-stunnel.doc&#34;&gt;application specific VPNs with Stunnel&lt;/a&gt; are available.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Using .Mac iDisk with a WatchGuard Firebox</title>
          <link>http://lowescott.github.io/2005/12/12/using-mac-idisk-with-a-watchguard-firebox/</link>
          <pubDate>Mon, 12 Dec 2005 00:37:38 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/12/12/using-mac-idisk-with-a-watchguard-firebox/</guid>
          <description>&lt;p&gt;One of the strengths of the &lt;a href=&#34;http://www.watchguard.com/&#34;&gt;WatchGuard&lt;/a&gt; &lt;a href=&#34;http://www.watchguard.com/products/appliances.asp&#34;&gt;Firebox&lt;/a&gt; series of firewalls is the inclusion of application-layer proxies for protocols such as SMTP, FTP, and HTTP. Whereas ordinary packet filtering firewalls and stateful inspection firewalls only control traffic based on IP address or TCP/UDP port number, application-layer proxies like those included in the Firebox look deeper into the packet to make decisions on information such as URL or MIME content type (for an HTTP proxy, for example).&lt;/p&gt;

&lt;p&gt;However, this advantage also becomes a disadvantage as many application-layer proxies may not understand or be compatible with protocol-specific extensions. In this particular case, it&amp;rsquo;s the iDisk service provided by Apple&amp;rsquo;s &lt;a href=&#34;http://www.mac.com/&#34;&gt;.Mac&lt;/a&gt; subscription service. The iDisk service uses &lt;a href=&#34;http://www.webdav.org/&#34;&gt;WebDAV&lt;/a&gt;, an extension of the HTTP/1.1 protocol specification. It appears that, in general, most WebDAV services operate properly through the Fireboxs HTTP proxy (although some issues with Microsoft Exchange&amp;rsquo;s Outlook Web Access were reported with earlier versions of the WatchGuard Firebox System software).&lt;/p&gt;

&lt;p&gt;The iDisk service, though, apparently uses some non-RFC-compliant headers (note that this was &lt;em&gt;not&lt;/em&gt; confirmed with a packet capture). As a result, the Proxied-HTTP service (which employs, as the name suggests, an application-layer HTTP proxy) prevents these headers from being passed and therefore prevents iDisk from working.&lt;/p&gt;

&lt;p&gt;To make iDisk work from behind a WatchGuard Firebox firewall, one of several steps must be taken:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Use the Filtered-HTTP service, which does not employ an application-layer HTTP proxy and therefore would not interfere with iDisk or other WebDAV-based applications or services.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Modify the default properties of the Proxied-HTTP service to allow unknown headers.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Since the Proxied-HTTP service also provides for content filtering and reporting, it is generally preferred to use the HTTP proxy instead of an ordinary HTTP packet filter. The first option is therefore not the ideal solution.&lt;/p&gt;

&lt;p&gt;Fortunately, the behavior of the Proxied-HTTP service is somewhat configurable. In order to make iDisk work with the HTTP proxy, the &amp;ldquo;Remove unknown headers&amp;rdquo; option must be unchecked in the configuration for the HTTP proxy. By unchecking the &amp;ldquo;Remove unknown headers&amp;rdquo; option, the Firebox will allow non-RFC-compliant HTTP headers to pass through the firewall, and iDisk will work correctly.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>WatchGuard Firebox VPN and Active Directory Integration</title>
          <link>http://lowescott.github.io/2005/12/06/watchguard-firebox-vpn-and-active-directory-integration/</link>
          <pubDate>Tue, 06 Dec 2005 17:38:24 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/12/06/watchguard-firebox-vpn-and-active-directory-integration/</guid>
          <description>

&lt;p&gt;A short while back, I posted an article on &lt;a href=&#34;http://blog.scottlowe.org/2005/11/22/cisco-pix-vpn-and-active-directory-integration/&#34;&gt;Cisco PIX VPN and Active Directory integration&lt;/a&gt;. Now, I&amp;rsquo;d like to follow that article up with a version looking at integration between Active Directory and &lt;a href=&#34;http://www.watchguard.com/&#34;&gt;WatchGuard&lt;/a&gt; Firebox VPNs.&lt;/p&gt;

&lt;p&gt;As with the PIX-AD integration document, this article assumes that you have some basic knowledge of how to work with the WatchGuard Firebox series of firewalls. This article was written using version 6.2 of the WatchGuard Firebox System software and Windows Server 2003; other versions of either the firewall software or Windows should be similar.&lt;/p&gt;

&lt;h3 id=&#34;toc_0&#34;&gt;Configuring the Firebox&lt;/h3&gt;

&lt;p&gt;First, we&amp;rsquo;ll need to setup the Firebox. Use the Firebox software (Policy Manager, specifically) to perform the following configuration tasks:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Add the server that is running IAS (or will be running IAS; see below) as a RADIUS server in the Authentication Servers dialog box (found on the Setup menu). Here, you&amp;rsquo;ll need to specify the server&amp;rsquo;s IP address, port number (the default of 1645 will be fine), and the shared secret.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Instruct the firewall to use RADIUS by going to Setup &amp;gt; Firewall Authentication and selecting &amp;ldquo;RADIUS&amp;rdquo; as the authentication type.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Configure the firewall&amp;rsquo;s Remote User VPN (on the Network menu) to use RADIUS by checking the &amp;ldquo;Use RADIUS to authenticate remote users&amp;rdquo; check box.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Once this is done, proceed with configuring PPTP-based remote user VPNs as usual. Be sure to add a rule allowing traffic to/from the pptp_users group; otherwise, VPN users will be subject to the same traffic restrictions as Internet users.&lt;/p&gt;

&lt;h3 id=&#34;toc_1&#34;&gt;Configuring Internet Authentication Service&lt;/h3&gt;

&lt;p&gt;Before doing anything else, create a new global security group in Active Directory. Call it &amp;ldquo;pptp_users&amp;rdquo;, just like the name of the group on the Firebox. This is an important part of the glue that will bind the Firebox together with Active Directory.&lt;/p&gt;

&lt;p&gt;If IAS is not already installed, install IAS using the Add/Remove Programs icon in Control Panel.&lt;/p&gt;

&lt;p&gt;Once it has been installed, launch it from the Administrative Tools folder on the Start Menu and we&amp;rsquo;ll proceed with configuring it for authenticating VPN connections to the Firebox.&lt;/p&gt;

&lt;p&gt;First, we need to grant IAS permission to read dial-in properties from user accounts in Active Directory. To do this, right-click on the &amp;ldquo;Internet Authentication Service (Local)&amp;rdquo; and select &amp;ldquo;Register Server in Active Directory&amp;rdquo;. Select Yes (or OK) if prompted to confirm. Note that if IAS was already installed, it may have already been registered with Active Directory as well.&lt;/p&gt;

&lt;p&gt;With that done, we can now configure the Firebox as a RADIUS client. Right-click on RADIUS Clients and select New RADIUS Client. In the wizard, specify the IP address (or DNS name) of the Firebox&amp;rsquo;s trusted interface and the shared secret. Note that this shared secret is the same secret key specified when configuring the RADIUS server in the Firebox previously. RADIUS clients use this to authenticate to RADIUS servers, so make it a reasonably strong password.&lt;/p&gt;

&lt;p&gt;Now create a new remote access policy. Right-click on Remote Access Policies and select New Remote Access Policy. In the wizard, specify a name, select to create a custom policy, and then add the following conditions to the policy:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;NAS-IP-Address: This will be the IP address of the Firebox&amp;rsquo;s trusted interface. This helps to ensure that this policy only applies to VPN requests from this firewall and not from any other RADIUS client.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Windows-Groups: This should be the &amp;ldquo;pptp_users&amp;rdquo; security group created earlier. Any user that should be allowed to authenticate on a VPN connection will need to be a member of this group.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Of course, this policy should grant access. On the next screen, select &amp;ldquo;Edit Profile&amp;rdquo; to edit the remote access profile. This is important because we&amp;rsquo;ll need to verify that the RADIUS server is passing the correct information to the Firebox.&lt;/p&gt;

&lt;p&gt;On the Advanced tab, remove all the attributes listed there (Service-Type and Framed-Protocol are there by default) and then add the Filter-Id attribute. To this attribute, add the string value &amp;ldquo;pptp_users&amp;rdquo;. Click OK to save these changes to the profile and then finish creating the policy.&lt;/p&gt;

&lt;p&gt;Make this policy the first policy (using the Move Up/Move Down commands in the IAS console), add a user to the group created earlier, and then test your connection. Remote systems attempting to connect via PPTP should now be able to authenticate the VPN connection using their Active Directory usernames and passwords.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;UPDATE:&lt;/strong&gt; I&amp;rsquo;ve updated this entry to correct some errors pointed out in the comments. Thanks for the feedback!&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Protecting OWA with Apache</title>
          <link>http://lowescott.github.io/2005/12/03/protecting-owa-with-apache/</link>
          <pubDate>Sat, 03 Dec 2005 00:21:54 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/12/03/protecting-owa-with-apache/</guid>
          <description>&lt;p&gt;Outlook Web Access (OWA) is the web-based interface for accessing e-mail and other resources handled by &lt;a href=&#34;http://www.microsoft.com/exchange/&#34;&gt;Microsoft Exchange&lt;/a&gt;. Unfortunately, OWA&amp;rsquo;s popularity also makes it the target of numerous worms and security exploits. As a result, many organizations seek to deploy OWA behind a reverse proxy that can help shield OWA from web-based attacks and exploits. In this posting, I&amp;rsquo;m going to share information to help build a reverse proxy using &lt;a href=&#34;http://www.apache.org/httpd/&#34;&gt;Apache 2.0&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Here&amp;rsquo;s a skeleton of an &lt;code&gt;httpd.conf&lt;/code&gt; file to support Apache as a reverse proxy in front of OWA:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;NameVirtualHost 1.2.3.4:80  
NameVirtualHost 1.2.3.4:443  
ProxyRequests Off

&amp;lt;VirtualHost 1.2.3.4:443&amp;gt;  
ServerAdmin webmaster@domain.com  
ServerName webmail.domain.com  
DocumentRoot /var/www/webmail  
RequestHeader set Front-End-Https &amp;quot;On&amp;quot;  
ProxyRequests Off  
ProxyPreserveHost On  

SSLEngine On  
SSLCertificateFile conf/webmail-ssl-cert.pem

&amp;lt;Location /exchange&amp;gt;  
ProxyPass http://mail.domain.com/exchange  
ProxyPassReverse http://mail.domain.com/exchange  
SSLRequireSSL  
&amp;lt;/Location&amp;gt;

&amp;lt;Location /exchweb&amp;gt;  
ProxyPass http://mail.domain.com/exchweb  
ProxyPassReverse http://mail.domain.com/exchweb  
SSLRequireSSL  
&amp;lt;/Location&amp;gt;

&amp;lt;Location /public&amp;gt;  
ProxyPass http://mail.domain.com/public  
ProxyPassReverse http://mail.domain.com/public  
SSLRequireSSL  
&amp;lt;/Location&amp;gt;

&amp;lt;/VirtualHost&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The key portions of this configuration are described below, along with some supporting information.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;em&gt;NameVirtualHost:&lt;/em&gt; The NameVirtualHost directive enables Apache to use name-based virtual hosts on the specified IP addresses and ports. The parameter to the NameVirtualHost directive must match one of the VirtualHost definitions, as shown in the sample configuration, or else the content will be served from the default virtual host (the first virtual host listed in the configuration). Note that if the Apache reverse proxy will not be using name-based virtual hosts (instead using IP address-based virtual hosts or running only a single server instance), then this directive is not required.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;em&gt;RequestHeader:&lt;/em&gt; This directive instructs Apache to add a header &amp;ldquo;Front-End-Https: On&amp;rdquo; to requests sent to the internal OWA server. This header is proprietary to OWA and forces OWA to build URLs using &amp;ldquo;https://&amp;rdquo; references instead of ordinary &amp;ldquo;http://&amp;rdquo; references. This directive is required in order to terminate the SSL tunnel at the reverse proxy and use clear-text HTTP between the reverse proxy and the internal OWA server. This directive requires the &lt;code&gt;mod_headers&lt;/code&gt; module.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;em&gt;ProxyPreserveHost:&lt;/em&gt; This directive configures Apache to pass the original host header, supplied by the client, to the server to which the request is being proxied. (This is instead of the host name supplied in the ProxyPass directive.) Again, this facilitates the construction of URLs with the correct hostname when accessing resources inside OWA.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;em&gt;SSLCertificateFile:&lt;/em&gt; Apache expects the web server&amp;rsquo;s SSL certificate to be in PEM format. If the certificate&amp;rsquo;s key is encrypted, Apache will prompt upon startup for the passphrase to the key (this prevents any form of automated startup). It is considered a security best practice to keep the key in a separate file (using the SSLCertificateKeyFile directive) in encrypted form and supply the password upon the startup of Apache.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;With this configuration in place, the following benefits are realized:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Name-based virtual hosts are supported. This allows other URLs to also be proxied through this same reverse proxy server.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;SSL encryption is offloaded from the Exchange server to the reverse proxy server. Traffic from the reverse proxy server itself to the Exchange server is standard, unencrypted HTTP.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;When used in conjunction with &lt;a href=&#34;http://www.modsecurity.org/&#34;&gt;mod_security&lt;/a&gt; (another Apache module), OWA is protected against a very significant majority of all web-based attacks.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Using Apache to serve as a reverse proxy for OWA is a cost-effective way to add another layer of security to an Exchange-based messaging infrastructure.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Certificate Conversion Using OpenSSL</title>
          <link>http://lowescott.github.io/2005/12/02/certificate-conversion-using-openssl/</link>
          <pubDate>Fri, 02 Dec 2005 16:08:35 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/12/02/certificate-conversion-using-openssl/</guid>
          <description>&lt;p&gt;In my various adventures with replacing Windows-based servers with Linux servers, I have had need on several occasions to take an SSL certificate (generated using Microsoft Certificate Services) and make it available to a Linux-based server. In some cases, it was to be used by the SSL wrapper &lt;a href=&#34;http://stunnel.mirt.net/index.html&#34;&gt;Stunnel&lt;/a&gt;; in others, it was for &lt;a href=&#34;http://www.apache.org/httpd/&#34;&gt;Apache&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In either case, the certificate needed to be in the PEM (originally Privacy Enhanced Mail, now a standard for encoding certificates) format. Windows, on the other hand, typically uses the PFX (PKCS #12) format for storing certificates. To prepare certificates for use on Linux, the certificates must be converted to PEM format.&lt;/p&gt;

&lt;p&gt;In the hopes that this information might be useful to others, here&amp;rsquo;s a process for converting from PFX to PEM using &lt;a href=&#34;http://www.openssl.org/&#34;&gt;OpenSSL&lt;/a&gt;. With the exception of only a few items, the process is identical on Linux, &lt;a href=&#34;http://www.apple.com/macosx/&#34;&gt;Mac OS X&lt;/a&gt;, and &lt;a href=&#34;http://www.microsoft.com/windowsserver2003/default.mspx&#34;&gt;Windows &lt;sup&gt;2000&lt;/sup&gt;&amp;frasl;&lt;sub&gt;2003&lt;/sub&gt;&lt;/a&gt;. These steps were confirmed using OpenSSL 0.9.7a on Red Hat Linux 9.0, using OpenSSL 0.9.6i on Mac OS X 10.2.8, and OpenSSL 0.9.7c on Windows Server 2003.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;If the certificate is not already available in PFX format, use the Certificates MMC snap-in to export the certificate and the corresponding private key to a PFX file. Be sure to note the passphrase used to protect the PFX file; it will be needed later. If the certificate (and its corresponding private key) is already available in PFX format and the passphrase for the PFX file is known, proceed to step 2.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;At a terminal prompt, type &lt;code&gt;openssl pkcs12 -in _pfxfilename.pfx_ -out _tempfile.pem_&lt;/code&gt;. This will convert the PFX file to a PEM file. The OpenSSL toolkit will prompt for the import passphrase; this will be the passphrase specified in step 1. A PEM passphrase will also be needed; make note of the passphrase used here (it will be needed later).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Using a text editor (such as vi on a Linux system, or Notepad on a Windows system), split the encrypted RSA private key and the certificate into two separate files. Remove all extra text, leaving only the text between the lines with the dashes. Make note of the filenames; they will be needed later.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The RSA key is currently encrypted; this will an automated launch for the application using the certificate. It will be necessary to decrypt the RSA private key. To decrypt the RSA private key, use the command &lt;code&gt;openssl rsa -in _encryptedkey_ -out _decryptedkey_&lt;/code&gt; (where &lt;em&gt;encryptedkey&lt;/em&gt; is the file containing the RSA private key, as separated in step 3, and &lt;em&gt;decryptedkey&lt;/em&gt; is the file that will contain the decrypted RSA private key). The OpenSSL toolkit will prompt for the RSA key passphrase; this will be the passphrase specified in step 2.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;On Linux or Mac OS X: To concatenate the decrypted RSA private key and the certificate into a single file, use the command &lt;code&gt;cat _decryptedkey certificatefile_ &amp;gt; _finalfile.pem_&lt;/code&gt; (where &lt;em&gt;decryptedkey&lt;/em&gt; is the decrypted RSA key produced in step 4 and &lt;em&gt;certificatefile&lt;/em&gt; is the file containing only the certificate, as produced in step 3).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;On Windows: To combine the decrypted RSA private key and the certificate into a single file, use the command &lt;code&gt;copy /b _decryptedkey_+_certificatefile_ _finalfile.pem_&lt;/code&gt; (where &lt;em&gt;decryptedkey&lt;/em&gt; is the decrypted RSA key produced in step 4 and &lt;em&gt;certificatefile&lt;/em&gt; is the file containing only the certificate, as produced in step 3).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Edit the concatenated file (finalfile.pem from step 5) with a text editor to add a blank line between the decrypted RSA private key and the certificate, and a blank line after the end of the certificate.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;At this point, the certificate is ready for use. &lt;strong&gt;&lt;em&gt;Be sure&lt;/em&gt;&lt;/strong&gt; to guard the unencrypted private key with extreme caution; loss of this file can result in the compromise of your system. Note also that most applications require that the certificates be owned by root and readable only by root (&lt;code&gt;chown root:root&lt;/code&gt; to make them owned by root and &lt;code&gt;chmod 600&lt;/code&gt; to make them readable only by root).&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Secure Remote Filesystem</title>
          <link>http://lowescott.github.io/2005/11/29/secure-remote-filesystem/</link>
          <pubDate>Tue, 29 Nov 2005 16:57:00 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/11/29/secure-remote-filesystem/</guid>
          <description>&lt;p&gt;This is something that only a computer junkie could enjoy. In conjunction with the &lt;a href=&#34;http://fuse.sourceforge.net/&#34;&gt;FUSE&lt;/a&gt; project (now an official part of the Linux kernel as of version 2.6.14), an SSH-wrapped remote filesystems&amp;ndash;called &lt;a href=&#34;http://fuse.sourceforge.net/sshfs.html&#34;&gt;sshfs&lt;/a&gt;&amp;ndash;has been created.&lt;/p&gt;

&lt;p&gt;This &lt;a href=&#34;http://www.linux.com/article.pl?sid=05/11/11/176206&#34;&gt;recent article&lt;/a&gt; describes sshfs in a bit more detail and provides some additional information.&lt;/p&gt;

&lt;p&gt;So what does this mean? It means that for any remote system you can reach via SSH, you can mount that remote system&amp;rsquo;s filesystem inside an SSH tunnel. I can think of numerous possibilities, not the least of which involves easily updating a web site hosted on a remote web server without having to FTP (or SFTP) the files back and forth.&lt;/p&gt;

&lt;p&gt;Now, if only there was a &lt;a href=&#34;http://www.apple.com/macosx/&#34;&gt;Mac OS X&lt;/a&gt; version of sshfs&amp;hellip;it&amp;rsquo;s currently only available for Linux and &lt;a href=&#34;http://www.freebsd.org/&#34;&gt;FreeBSD&lt;/a&gt;.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>IE Exploit Moves from DoS to Remote Code Execution</title>
          <link>http://lowescott.github.io/2005/11/29/ie-exploit-moves-from-dos-to-remote-code-execution/</link>
          <pubDate>Tue, 29 Nov 2005 16:15:45 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/11/29/ie-exploit-moves-from-dos-to-remote-code-execution/</guid>
          <description>&lt;p&gt;As a follow-up to my posting &lt;a href=&#34;http://blog.scottlowe.org/2005/11/21/zero-day-ie-exploit/&#34;&gt;Zero-Day IE Exploit&lt;/a&gt;, it has now been discovered that this exploit is no longer just a denial of service (DoS) flaw, but rather a flaw that can allow remote code execution (see &lt;a href=&#34;http://www.security.ithub.com/article/Unpatched+IE+Flaw+Is+Worse+Than+Expected/166164_1.aspx&#34;&gt;here&lt;/a&gt; for more information). As of this writing, there is no patch for this vulnerability and the only workaround is to disable Active Scripting in IE.&lt;/p&gt;

&lt;p&gt;For your convenience, here&amp;rsquo;s a &lt;a href=&#34;http://support.microsoft.com/kb/q154036/&#34;&gt;link&lt;/a&gt; to a Microsoft KB article that describes how to disable Active Scripting.&lt;/p&gt;

&lt;p&gt;Alternately, you can just switch to &lt;a href=&#34;http://www.mozilla.org/products/firefox/&#34;&gt;Firefox&lt;/a&gt; (which, by the way, is supposed to release Firefox 1.5 sometime today).&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>ipfw Rules for Bonjour</title>
          <link>http://lowescott.github.io/2005/11/28/ipfw-rules-for-bonjour/</link>
          <pubDate>Mon, 28 Nov 2005 16:11:38 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/11/28/ipfw-rules-for-bonjour/</guid>
          <description>&lt;p&gt;I originally published this information on my business website, but thought I&amp;rsquo;d reproduce it here in the event someone needs it.&lt;/p&gt;

&lt;p&gt;Apple&amp;rsquo;s &lt;a href=&#34;http://www.apple.com/macosx/features/bonjour/&#34;&gt;Bonjour&lt;/a&gt; (formerly Rendezvous) auto-discovery service is used in a number of Apple-branded products as well as a growing number of third-party applications (for example, my HP Color LaserJet 2550N supports Bonjour). It&amp;rsquo;s used to advertise and discover &lt;a href=&#34;http://www.apple.com/itunes/&#34;&gt;iTunes&lt;/a&gt; music libraries, and Apple&amp;rsquo;s Airport Admin Utility also uses Bonjour to discover &lt;a href=&#34;http://www.apple.com/airportextreme/&#34;&gt;Airport Extreme&lt;/a&gt; and &lt;a href=&#34;http://www.apple.com/airportexpress/&#34;&gt;Airport Express&lt;/a&gt; wireless base stations for configuration.&lt;/p&gt;

&lt;p&gt;Bonjour uses &lt;a href=&#34;http://www.multicastdns.org/&#34;&gt;multicast DNS&lt;/a&gt; (known as mDNS), part of the IETF standard known as &lt;a href=&#34;http://www.zeroconf.org/&#34;&gt;Zeroconf&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;All that is well and good, but if you are using the built-in firewall you most likely are preventing Bonjour from working correctly. I grew frustrated trying to utilize Bonjour-related services while also keeping my &lt;a href=&#34;http://www.apple.com/powerbook/&#34;&gt;PowerBook&lt;/a&gt; protected against unwanted network traffic. Using a packet sniffer and Brian Hill&amp;rsquo;s &lt;a href=&#34;http://personalpages.tds.net/~brian_hill/brickhouse.html&#34;&gt;Brickhouse&lt;/a&gt; application, I observed Bonjour traffic and created a set of ipfw rules that can be used to allow this traffic.&lt;/p&gt;

&lt;p&gt;Multicast DNS operates over UDP (IP protocol 17) with a destination port 5353 and a source port above 1024. The destination address is, of course, a multicast address (in the 224.0.0.0 range). Responses to mDNS multicasts originate from UDP port 5353, but are bound for a random high port above 1024. Simply defining a rule that allows traffic to and from UDP port 5353 wont work, because while outbound traffic will be correctly matched the responses to those outbound requests wont be matched and will be dropped (assuming the default action is to deny traffic). So, a sample rule to be added to ipfw might look something like this:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;add 2008 allow udp from 10.1.1.0/24 5353 to any 1024-65535 in via en0&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;(This should be entered all on a single line.)&lt;/p&gt;

&lt;p&gt;This rule allows traffic from the source network 10.1.1.0 (the &amp;ldquo;/24&amp;rdquo; indicating a 24-bit mask, i.e., a subnet mask of 255.255.255.0) from UDP source port 5353 to any port above 1024 on any destination address inbound via the en0 interface. The en0 interface is typically the built-in Ethernet interface on most &lt;a href=&#34;http://www.apple.com/macosx/&#34;&gt;Mac OS X&lt;/a&gt;-based systems. (Likewise, en1 is typically the built-in AirPort/AirPort Extreme wireless interface.)&lt;/p&gt;

&lt;p&gt;If you are tightly restricting outbound traffic as well, you&amp;rsquo;ll need a matching outbound rule (of course).&lt;/p&gt;

&lt;p&gt;My own experience has shown that adding this rule to my ipfw ruleset has allowed Bonjour to work as expected without sacrificing the security of my system.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Cisco PIX VPN and Active Directory Integration</title>
          <link>http://lowescott.github.io/2005/11/22/cisco-pix-vpn-and-active-directory-integration/</link>
          <pubDate>Tue, 22 Nov 2005 19:01:54 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/11/22/cisco-pix-vpn-and-active-directory-integration/</guid>
          <description>

&lt;p&gt;Rather than publishing this information in PDF form on my business website, I&amp;rsquo;ve decided to try something new and post it here as a blog entry. So, here goes.&lt;/p&gt;

&lt;p&gt;This information assumes that you have some experience with the Cisco PIX firewall (i.e., you know how to enter configuration commands and have a basic idea of what the configuration commands actually do) as well as some experience with Windows and Active Directory.&lt;/p&gt;

&lt;p&gt;With that information in hand, let&amp;rsquo;s get started.&lt;/p&gt;

&lt;h2 id=&#34;toc_0&#34;&gt;Configuring the Cisco PIX&lt;/h2&gt;

&lt;p&gt;First, we&amp;rsquo;ll need to setup the PIX firewall. Use the commands below to configure the PIX for PPTP-based VPN connections that will authenticate against an Active Directory back-end.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ip local pool vpn-pool 10.10.10.1-10.10.10.254  
aaa-server vpn-auth inside host 10.10.10.5 secretkey  
aaa-server vpn-auth inside host 10.10.10.6 secretkey  
aaa-server vpn-auth protocol radius  
vpdn group vpn-pptp-group accept dialin pptp  
vpdn group vpn-pptp-group ppp authentication mschap  
vpdn group vpn-pptp-group ppp encryption mppe 128 required  
vpdn group vpn-pptp-group client configuration \  
address local vpn-pool  
vpdn group vpn-pptp-group client configuration \  
dns 10.10.10.5 10.10.10.6  
vpdn group vpn-pptp-group client configuration \  
wins 10.10.10.6 10.10.10.5  
vpdn group vpn-pptp-group client authentication aaa vpn-auth  
vpdn enable outside  
sysopt connect permit-pptp  
access-list acl-nat0 permit ip 10.10.1.0 255.255.255.0 \  
10.10.10.0 255.255.255.0  
nat (inside) 0 access-list acl-nat0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(Note that I have placed a backslash to indicate text that is wrapped onto two lines here but should be entered all on a single line in the PIX configuration.)&lt;/p&gt;

&lt;p&gt;In this configuration, replace the IP addresses on lines 2 and 3 (the &lt;code&gt;aaa-server vpn-auth&lt;/code&gt; commands) with the IP addresses of the servers running Internet Authentication Service (IAS) on Windows. See the next section for more information on configuring IAS.&lt;/p&gt;

&lt;p&gt;On those same lines, replace the text &lt;code&gt;secretkey&lt;/code&gt; with the RADIUS shared secret that will be used when configuring the RADIUS/IAS server in the next section.&lt;/p&gt;

&lt;p&gt;Likewise, replace the IP addresses on lines 9 and 10 (the &lt;code&gt;vdpn group vpn-pptp-group client configuration&lt;/code&gt; lines that pass out the DNS and WINS servers to VPN clients) with the IP addresses of your DNS and WINS servers, respectively.&lt;/p&gt;

&lt;p&gt;That should do it. Save the configuration to the PIX and then move on to configuring IAS.&lt;/p&gt;

&lt;h2 id=&#34;toc_1&#34;&gt;Configuring Internet Authentication Service&lt;/h2&gt;

&lt;p&gt;Before doing anything else, create a new global security group in Active Directory. Call it something like &amp;ldquo;VPN Users&amp;rdquo; or similar. We&amp;rsquo;ll use this group later as an additional security check in validating VPN connections.&lt;/p&gt;

&lt;p&gt;Next, install IAS using the Add/Remove Programs icon in Control Panel. Once it has been installed, launch it from the Administrative Tools folder on the Start Menu and we&amp;rsquo;ll proceed with configuring it for authenticating VPN connections to the PIX firewall.&lt;/p&gt;

&lt;p&gt;First, we need to grant IAS permission to read dial-in properties from user accounts in Active Directory. To do this, right-click on the &amp;ldquo;Internet Authentication Service (Local)&amp;rdquo; and select &amp;ldquo;Register Server in Active Directory&amp;rdquo;. Select Yes (or OK) if prompted to confirm.&lt;/p&gt;

&lt;p&gt;With that done, we can now configure the PIX firewall as a RADIUS client. Right-click on RADIUS Clients and select New RADIUS Client. In the wizard, specify the IP address (or DNS name) of the PIX firewall&amp;rsquo;s internal IP address and the shared secret. Note that this shared secret is the same secret key specified in the PIX configuration above. RADIUS clients use this to authenticate to RADIUS servers, so make it a reasonably strong password.&lt;/p&gt;

&lt;p&gt;Now create a remote access policy. Right-click on Remote Access Policies and select New Remote Access Policy. In the wizard, specify a name, select to create a custom policy, and then add the following conditions to the policy:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;NAS-IP-Address: This will be the IP address of the PIX firewall&amp;rsquo;s internal interface. This helps to ensure that this policy only applies to VPN requests from this firewall and not from any other RADIUS client.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Windows-Groups: This should be the security group created earlier. Any user that should be allowed to authenticate on a VPN connection will need to be a member of this group.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The rest of the policy should be very straightforward. Make this policy the first policy (using the Move Up/Move Down commands in the IAS console), add a user to the group created earlier, and then test your connection. Remote systems attempting to connect via PPTP should now be able to authenticate the VPN connection using their Active Directory usernames and passwords.&lt;/p&gt;

&lt;p&gt;Although this was written from the perspective of authenticating PPTP connections, the process should be very similar for IPSec VPN clients as well.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Zero-Day IE Exploit</title>
          <link>http://lowescott.github.io/2005/11/21/zero-day-ie-exploit/</link>
          <pubDate>Mon, 21 Nov 2005 23:02:43 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/11/21/zero-day-ie-exploit/</guid>
          <description>&lt;p&gt;&lt;a href=&#34;http://www.eweek.com/article2/0,1759,1891749,00.asp&#34;&gt;This article&lt;/a&gt; discusses a newly-discovered zero-day exploit for Internet Explorer, including IE on fully-patched Windows XP SP2 systems. (Apparently, only Windows Server 2003 with the Enhanced Security Configuration is immune.)&lt;/p&gt;

&lt;p&gt;No patch has been released, and no security advisory had been posted at the time this was written. A Microsoft security advisory was expected at any moment.&lt;/p&gt;

&lt;p&gt;In the meantime, switch to &lt;a href=&#34;http://www.mozilla.org/products/firefox/&#34;&gt;Firefox&lt;/a&gt;. No, really&amp;mdash;I&amp;rsquo;m serious.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;UPDATE:&lt;/strong&gt; Microsoft has posted a &lt;a href=&#34;http://www.microsoft.com/technet/security/advisory/911302.mspx&#34;&gt;security advisory&lt;/a&gt; about this issue.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Sony Keeps Digging Itself Deeper</title>
          <link>http://lowescott.github.io/2005/11/10/sony-keeps-digging-itself-deeper/</link>
          <pubDate>Thu, 10 Nov 2005 19:00:21 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/11/10/sony-keeps-digging-itself-deeper/</guid>
          <description>&lt;p&gt;The furor over the rootkit technology used by Sony in their DRM software continues to grow. After Mark Russinovich &lt;a href=&#34;http://www.sysinternals.com/blog/2005/10/sony-rootkits-and-digital-rights.html&#34;&gt;unveiled the truth&lt;/a&gt;, Sony released a patch that supposedly allows for the DRM technology to be uninstalled. Of course, Mark &lt;a href=&#34;http://www.sysinternals.com/blog/2005/11/more-on-sony-dangerous-decloaking.html&#34;&gt;reviewed the uninstallation&lt;/a&gt;, and he found it left a little bit to be desired (putting it mildly). Basically, it left you at risk of a blue screen of death. And Mark&amp;rsquo;s not the only one not satisfied&amp;ndash;&lt;a href=&#34;http://www.eweek.com/article2/0,1759,1883820,00.asp&#34;&gt;this article&lt;/a&gt; cites several other security experts as well who are not happy with this situation.&lt;/p&gt;

&lt;p&gt;Then, First 4 Internet (the company behind the cloaking technology that Sony uses for their DRM software) &lt;a href=&#34;http://www.sysinternals.com/blog/2005/11/sonys-rootkit-first-4-internet.html&#34;&gt;responds&lt;/a&gt; to Mark&amp;rsquo;s posts and attempts to refute his findings. Finally, today, Mark posted more details on the &lt;a href=&#34;http://www.sysinternals.com/blog/2005/11/sony-you-dont-reeeeaaaally-want-to_09.html&#34;&gt;actual uninstallation process&lt;/a&gt; and what is required in order to make it work.&lt;/p&gt;

&lt;p&gt;Sony just keeps digging itself deeper and deeper into this hole. It&amp;rsquo;s bad enough that the company uses stealth/cloaking technologies to hide their files. It&amp;rsquo;s bad enough by itself that the DRM software is communicating back to Sony whenever a CD is played. It&amp;rsquo;s bad enough that the uninstallation process requires so many steps and is so complicated.&lt;/p&gt;

&lt;p&gt;Finally, to make matters worse&amp;hellip;check out &lt;a href=&#34;http://entmag.com/news/article.asp?editorialsid=7033&#34;&gt;this news&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Put it all together, and you get a mistake so massive that it could change Sony&amp;rsquo;s business fortunes. Don&amp;rsquo;t believe me? Are &lt;strong&gt;&lt;em&gt;you&lt;/em&gt;&lt;/strong&gt; going to buy any Sony CDs or software now, after everything that&amp;rsquo;s been disclosed? I&amp;rsquo;m not, that&amp;rsquo;s for sure. (Of course, I don&amp;rsquo;t really have to worry about it that much since I&amp;rsquo;m using a Mac and not Windows, but that&amp;rsquo;s a different story for a different day.)&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>It Was Bound to Happen</title>
          <link>http://lowescott.github.io/2005/11/09/it-was-bound-to-happen/</link>
          <pubDate>Wed, 09 Nov 2005 16:17:25 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/11/09/it-was-bound-to-happen/</guid>
          <description>&lt;p&gt;To a certain extent, I agree with the belief that operating systems and applications that don&amp;rsquo;t have a significant market share like Windows, IIS, and Exchange won&amp;rsquo;t get targeted as frequently and therefore will have a &amp;ldquo;better&amp;rdquo; security track record. I don&amp;rsquo;t agree that this is the &lt;em&gt;only&lt;/em&gt; reason that Linux, Mac OS X, and others haven&amp;rsquo;t seen as many security vulnerabilities and the oh-so-fun network worms that invariably accompany them. But I will agree that as these alternatives gain in popularity, more hackers are going to target them.&lt;/p&gt;

&lt;p&gt;As a result, it&amp;rsquo;s no surprise that a &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1882889,00.asp&#34;&gt;new Linux worm&lt;/a&gt; has recently emerged. I mean, it was bound to happen. Linux is surging in popularity, as Linus Torvalds and other developers continue to &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1881470,00.asp&#34;&gt;add features&lt;/a&gt; to the Linux kernel and more and more corporations deploy Linux. Of course the malware authors are going to try something like this. I doesn&amp;rsquo;t surprise me in the least. While this one is fairly low-tech, you can bet that future variants of this worm (as well as new worms) will be more complex and more dangerous.&lt;/p&gt;

&lt;p&gt;I also fully expect that the anti-Linux crowd will shout that this is the end of the line for Linux, just like the anti-Microsoft crowd shouts &amp;ldquo;Down with Windows!&amp;rdquo; everytime Microsoft patches a critical security flaw that could be exploited by an automated worm (side note: new Microsoft critical security flaw &lt;a href=&#34;http://www.microsoft.com/technet/security/Bulletin/MS05-053.mspx&#34;&gt;patched yesterday&lt;/a&gt;, go have a look and make sure you are protected). This just isn&amp;rsquo;t the case. Neither Windows nor Linux are going to go away, and each of them has value for businesses today. The best bet for any organization is to use the product that best fits the need and then make sure that the product is:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;properly &lt;em&gt;configured&lt;/em&gt;;&lt;/li&gt;
&lt;li&gt;properly &lt;em&gt;patched&lt;/em&gt;; and&lt;/li&gt;
&lt;li&gt;properly &lt;em&gt;maintained&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Following these guidelines, businesses and consumers can safely deploy the products, technologies, and platforms that best meet their needs without falling prey to technology bigotry.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Rootkit Technology in Sony DRM</title>
          <link>http://lowescott.github.io/2005/11/02/rootkit-technology-in-sony-drm/</link>
          <pubDate>Wed, 02 Nov 2005 19:16:28 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/11/02/rootkit-technology-in-sony-drm/</guid>
          <description>&lt;p&gt;A &lt;a href=&#34;http://www.sysinternals.com/blog/2005/10/sony-rootkits-and-digital-rights.html&#34;&gt;very in-depth article&lt;/a&gt; by Mark Russinovich unveiled that DRM technology shipping with recent Sony BMG CDs actually installs &lt;a href=&#34;http://en.wikipedia.org/wiki/Rootkit&#34;&gt;rootkit&lt;/a&gt; components onto your system. Now, I don&amp;rsquo;t know about you, but I don&amp;rsquo;t like the idea of a vendor &lt;em&gt;unknowingly&lt;/em&gt; installing software on my computer(s) that contain rootkit components&amp;ndash;especially when those rootkit components could be used by malicious software packages to hide themselves.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;m glad to see that &lt;em&gt;eWeek&lt;/em&gt; &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1880543,00.asp&#34;&gt;picked up the story&lt;/a&gt; as well. (Note that O&amp;rsquo;Reilly&amp;rsquo;s ONLamp.net is &lt;a href=&#34;http://www.oreillynet.com/pub/wlg/8269?CMP=OTC-6YE827253101&#34;&gt;mentioning it&lt;/a&gt; as well.) Mark&amp;rsquo;s research is fantastic (as always), but not many people will get exposed to this news through him alone. Computer geeks like myself would, of course, but the people that really need to know this are the non-geeks. Any reasonably computer-savvy user is likely to want to pick up your average CD (from any number of distribution channels, including &lt;a href=&#34;http://www.amazon.com/&#34;&gt;Amazon.com&lt;/a&gt;) and copy the music off the CD. There are a number of very valid reasons for this&amp;ndash;ease of access, personal backup copy (ever scratch a CD?), etc. Copy-protected CDs limit your ability to do this without also installing stealthy rootkit components onto your system.&lt;/p&gt;

&lt;p&gt;More links to other discussions on this topic can be found in section 8 of &lt;a href=&#34;http://en.wikipedia.org/wiki/Rootkit&#34;&gt;this Wikipedia rootkit article&lt;/a&gt; (also linked above).&lt;/p&gt;

&lt;p&gt;In my opinion, this is just plain wrong. It&amp;rsquo;s wrong to install this kind of software onto someone&amp;rsquo;s system. I can understand their desire to want to protect their &amp;ldquo;intellectual property,&amp;rdquo; but there&amp;rsquo;s got to be a better way than installing rootkits on your customers&amp;rsquo; computers.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>There&#39;s Got to be a Better Way</title>
          <link>http://lowescott.github.io/2005/07/29/theres-got-to-be-a-better-way/</link>
          <pubDate>Fri, 29 Jul 2005 23:27:35 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/07/29/theres-got-to-be-a-better-way/</guid>
          <description>&lt;p&gt;After reading this article about &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1841266,00.asp&#34;&gt;fourth-generation rootkits&lt;/a&gt;, I can&amp;rsquo;t help but think that there has to be a better way to get information out about these kinds of threats. Are we warning about pending threats, or are we creating the new threats ourselves? Do these kinds of presentations help us protect our computers and our networks, or do they give the other side the ammunition they need?&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Cisco IOS = Windows XP?</title>
          <link>http://lowescott.github.io/2005/07/29/cisco-ios-windows-xp/</link>
          <pubDate>Fri, 29 Jul 2005 15:43:00 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/07/29/cisco-ios-windows-xp/</guid>
          <description>&lt;p&gt;Well, the &lt;a href=&#34;http://www.blackhat.com/main.html&#34;&gt;Black Hat&lt;/a&gt; conference in Las Vegas certainly generated a great deal of excitement this past week. A security presentation was going to be given about a first-ever exploit for &lt;a href=&#34;http://www.cisco.com&#34;&gt;Cisco&lt;/a&gt; routers. From what I&amp;rsquo;ve been able to decipher, Cisco had been working closely with &lt;a href=&#34;http://www.iss.net&#34;&gt;ISS&lt;/a&gt;, the company whose researcher (Michael Lynn) was supposed to give the presentation, and both companies apparently agreed that the presentation needed further review. Cisco and ISS &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1841232,00.asp&#34;&gt;jointly filed an injunction&lt;/a&gt; against Michael Lynn when he &lt;a href=&#34;http://www.computerworld.com/securitytopics/security/holes/story/0,10801,103515,00.html&#34;&gt;quit his job at ISS to give the presentation&lt;/a&gt; anyway; this is after Cisco employees physically removed presentation pages from the books handed out at the conference and destroyed CDs containing information about the presentation.&lt;/p&gt;

&lt;p&gt;It appeared as if Lynn was going to give a VoIP presentation instead, but then &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1841166,00.asp&#34;&gt;proceeded with the original presentation&lt;/a&gt; anyway, even though he knew it would likely result in lawsuits from Cisco and his former employer. In the presentation, he likened Cisco&amp;rsquo;s IOS (Internetwork Operating System) to Microsoft Windows XP, saying &amp;ldquo;IOS is the Windows XP of the Internet.&amp;rdquo;&lt;/p&gt;

&lt;p&gt;Finally, Thursday, a court order was issued and &lt;a href=&#34;http://www.computerworld.com/securitytopics/security/story/0,10801,103561,00.html&#34;&gt;all parties involved have agreed&lt;/a&gt; to the terms of the court order, which restrict them from further sharing or disseminating any information about the security flaw.&lt;/p&gt;

&lt;p&gt;Both Cisco and ISS have taken a real hit from this whole situation, and I can understand why. Cisco looks like it&amp;rsquo;s trying to cover up security vulnerabilities; it was only after all of this that Cisco issued a &lt;a href=&#34;http://www.cisco.com/warp/public/707/cisco-sa-20050729-ipv6.shtml&#34;&gt;security advisory&lt;/a&gt; discussing the vulnerability. If Michael Lynn&amp;rsquo;s research was accurate, then it is appropriate for people to know so that our networks can be protected. Cisco network equipment running IOS does, indeed, power a large portion of the Internet. &lt;em&gt;At the same time&lt;/em&gt;, if he violated the law and the terms of his agreement with Cisco by reverse engineering IOS, then he should not have publicized that information. &lt;em&gt;But then again&lt;/em&gt;, it appears as if Cisco would not have released security information had Mr. Lynn not proceeded with the presentation, so&amp;hellip;you see that this issue is sensitive and there are reasonable and understandable concerns on all sides.&lt;/p&gt;

&lt;p&gt;To be honest, I don&amp;rsquo;t know what I would have done if I were in the same situation. The only advice that comes to mind is, &amp;ldquo;If you do what is right, you can&amp;rsquo;t go wrong.&amp;rdquo; But what is &lt;em&gt;&amp;ldquo;right&amp;rdquo;&lt;/em&gt; in this situation?&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Rootkit Prevention Coming to Windows</title>
          <link>http://lowescott.github.io/2005/07/19/rootkit-prevention-coming-to-windows/</link>
          <pubDate>Tue, 19 Jul 2005 15:17:43 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/07/19/rootkit-prevention-coming-to-windows/</guid>
          <description>&lt;p&gt;I &lt;a href=&#34;http://blog.scottlowe.org/2005/06/21/dangerous-stuff/&#34;&gt;blogged&lt;/a&gt; a while back about concerns that &lt;a href=&#34;http://en.wikipedia.org/wiki/Spyware&#34;&gt;spyware&lt;/a&gt; makers were adding &lt;a href=&#34;http://en.wikipedia.org/wiki/Root_kit&#34;&gt;rootkit&lt;/a&gt; functionality to their products to make them harder to detect and harder to remove. It seems that trend has gotten the attention of &lt;a href=&#34;http://www.microsoft.com&#34;&gt;Microsoft&lt;/a&gt;. (About time, I say.)&lt;/p&gt;

&lt;p&gt;Microsoft&amp;rsquo;s &lt;a href=&#34;http://www.microsoft.com/security/malwareremove/default.mspx&#34;&gt;Malicious Software Removal Tool&lt;/a&gt; has been enhanced with the ability to find and remove rootkit-like trojans and backdoor applications. In addition, Microsoft has indicated that it will likely &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1838294,00.asp&#34;&gt;incorporate anti-rootkit functionality&lt;/a&gt; into future versions of its &lt;a href=&#34;http://www.microsoft.com/athome/security/spyware/software/default.mspx&#34;&gt;AntiSpyware&lt;/a&gt; product, acquired with Giant Software and still in beta.&lt;/p&gt;

&lt;p&gt;Rootkits have been reported on virtually all major operating systems, so we can&amp;rsquo;t really knock Microsoft for allowing rootkits to infect Windows. We can, however, insist that as long as Microsoft makes it possible for the operating system to be compromised in such a significant way through the use of a web browser, then such stuff as &lt;a href=&#34;http://research.microsoft.com/rootkit/&#34;&gt;Strider Ghostbuster&lt;/a&gt; (Microsoft&amp;rsquo;s anti-rootkit technology) should continue to be offered to Windows users at no charge.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>It&#39;s Patch Tuesday Again</title>
          <link>http://lowescott.github.io/2005/07/13/its-patch-tuesday-again/</link>
          <pubDate>Wed, 13 Jul 2005 16:03:42 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/07/13/its-patch-tuesday-again/</guid>
          <description>&lt;p&gt;I suppose since I didn&amp;rsquo;t post this until Wednesday, the title isn&amp;rsquo;t exactly correct, is it?&lt;/p&gt;

&lt;p&gt;In any event, &lt;a href=&#34;http://www.microsoft.com&#34;&gt;Microsoft&lt;/a&gt; has released the &lt;a href=&#34;http://www.microsoft.com/technet/security/bulletin/ms05-jul.mspx&#34;&gt;security bulletin&lt;/a&gt; for July, which contains 3 critical updates (updates rated &amp;ldquo;critical&amp;rdquo; are considered the most severe by Microsoft). These updates patch security vulnerabilities in Microsoft Word, Internet Explorer, and Windows (including Windows Server 2003 SP1 and Windows XP SP2).&lt;/p&gt;

&lt;p&gt;Microsoft had previously released a &lt;a href=&#34;http://www.microsoft.com/technet/security/advisory/903144.mspx&#34;&gt;workaround&lt;/a&gt; for the Internet Explorer flaw (note that this page now directs users to the location of the update rather than the earlier workaround).&lt;/p&gt;

&lt;p&gt;Additional information on the patches can be found &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1836227,00.asp&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Firefox Updates and Roadmap</title>
          <link>http://lowescott.github.io/2005/07/13/firefox-updates-and-roadmap/</link>
          <pubDate>Wed, 13 Jul 2005 15:51:12 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/07/13/firefox-updates-and-roadmap/</guid>
          <description>&lt;p&gt;Mozilla released &lt;a href=&#34;http://www.mozilla.org/products/firefox/&#34;&gt;Firefox&lt;/a&gt; 1.0.5, which patches a number of security vulnerabilities. You can get more information on the release &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1836310,00.asp&#34;&gt;here&lt;/a&gt; or by visiting the &lt;a href=&#34;http://www.mozilla.org&#34;&gt;Mozilla.org&lt;/a&gt; web site.&lt;/p&gt;

&lt;p&gt;In addition, &lt;a href=&#34;http://www.eweek.com/article2/0,1895,1821168,00.asp&#34;&gt;more information&lt;/a&gt; has been revealed about Firefox 1.1, the next version of the open source web browser. An alpha version of Firefox 1.1 could be ready within just a few days.&lt;/p&gt;

&lt;p&gt;If Mozilla can continue to innovate with Firefox and address my two primary concerns&amp;ndash;ease of deployment and distributing security updates&amp;ndash;then they will continue to steal market share away from Internet Explorer. If nothing else, Mozilla will at least force Microsoft to be competitive again, and that is a success in and of itself.&lt;/p&gt;

&lt;p&gt;Mozilla is also updating &lt;a href=&#34;http://www.mozilla.org/products/thunderbird&#34;&gt;Thunderbird&lt;/a&gt;, the companion e-mail client to Firefox, and that update is expected to be available soon as well.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>The Ongoing Microsoft-Claria Saga</title>
          <link>http://lowescott.github.io/2005/07/11/the-ongoing-microsoft-claria-saga/</link>
          <pubDate>Mon, 11 Jul 2005 23:12:08 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/07/11/the-ongoing-microsoft-claria-saga/</guid>
          <description>&lt;p&gt;Apparently, Microsoft&amp;rsquo;s &lt;a href=&#34;http://www.microsoft.com/athome/security/spyware/software/claria_letter.mspx&#34;&gt;public statement&lt;/a&gt; regarding the downgrade of Claria software in their anti-spyware product (which now recommends that users ignore the Claria software instead of remove it) isn&amp;rsquo;t sitting well.&lt;/p&gt;

&lt;p&gt;In &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1835770,00.asp&#34;&gt;this article&lt;/a&gt; at &lt;em&gt;eWeek&lt;/em&gt;, a number of spyware experts call Microsoft&amp;rsquo;s explanation less than satisfactory. &lt;a href=&#34;http://www.edbott.com/weblog/archives/000844.html&#34;&gt;Ed Bott&lt;/a&gt;, &lt;a href=&#34;http://www.benedelman.org/news/063005-1.html&#34;&gt;Ben Edelman&lt;/a&gt;, and others have all commented on Microsoft&amp;rsquo;s explanation. The overwhelming consensus is that users don&amp;rsquo;t trust Microsoft to be honest. And why should they? Unfortunately, Microsoft has placed itself in an unenviable position, and only by being completely squeaky clean and transparent will it be able to avoid a backlash over actions such as this.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Access-Based Enumeration</title>
          <link>http://lowescott.github.io/2005/07/08/access-based-enumeration/</link>
          <pubDate>Fri, 08 Jul 2005 23:29:04 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/07/08/access-based-enumeration/</guid>
          <description>&lt;p&gt;&lt;a href=&#34;http://www.microsoft.com/windowsserver2003/&#34;&gt;Windows Server 2003&lt;/a&gt; has finally caught up with &lt;a href=&#34;http://www.novell.com/netware/&#34;&gt;Novell NetWare&lt;/a&gt; in one key area, and that is in the enumeration of files and folders. With &lt;a href=&#34;http://www.microsoft.com/downloads/details.aspx?FamilyID=04A563D9-78D9-4342-A485-B030AC442084&amp;amp;displaylang=en&#34;&gt;access-based enumeration&lt;/a&gt;, Windows Server 2003 now will display only those files and folders to which the user has permission. If no permission is given, the file or folder is not displayed. This is, in my opinion, a &lt;em&gt;major&lt;/em&gt; improvement in Windows&amp;rsquo; security.&lt;/p&gt;

&lt;p&gt;I plan to give this functionality a swing on my own servers within the next few days. I&amp;rsquo;ll post additional details here after my tests.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Stupid Tricks With The Mac OS X Firewall</title>
          <link>http://lowescott.github.io/2005/07/07/stupid-tricks-with-the-mac-os-x-firewall/</link>
          <pubDate>Thu, 07 Jul 2005 22:54:40 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/07/07/stupid-tricks-with-the-mac-os-x-firewall/</guid>
          <description>&lt;p&gt;Here&amp;rsquo;s an interesting way to block access to your &lt;a href=&#34;http://www.apple.com/macosx/&#34;&gt;Mac OS X&lt;/a&gt; system. Simply modify your ipfw script to block traffic to or from the 127.0.0.0/8 network. When you do this, your Mac will simply fail to log you in, instead presenting you with an endless spinning disk.&lt;/p&gt;

&lt;p&gt;The only workaround is to hold down the Shift key while booting (to initiate a Safe Boot), then disable the StartupItem that launches and configures the firewall.&lt;/p&gt;

&lt;p&gt;Of course, I speak from personal experience, having added the aforementioned rules in an effort to block spoofed traffic from accessing the loopback interface. Apparently, Mac OS X is different enough from &lt;a href=&#34;http://www.freebsd.org/&#34;&gt;FreeBSD&lt;/a&gt; that this advice (advocated on a couple of FreeBSD-related sites I found while searching for ipfw information) is &lt;em&gt;not&lt;/em&gt; recommended.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Equal Opportunity Security Flaw</title>
          <link>http://lowescott.github.io/2005/07/07/equal-opportunity-security-flaw/</link>
          <pubDate>Thu, 07 Jul 2005 18:24:19 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/07/07/equal-opportunity-security-flaw/</guid>
          <description>&lt;p&gt;At least it can&amp;rsquo;t be said that I only identify and write about Microsoft-related security flaws. (I&amp;rsquo;d like to not have to write about security flaws at all, but that doesn&amp;rsquo;t look like it&amp;rsquo;s going to happen.)&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.eweek.com/article2/0,1759,1834632,00.asp&#34;&gt;This Zlib flaw&lt;/a&gt; affects Linux, BSD, and even some Microsoft products. It&amp;rsquo;s an equal opportunity security flaw.&lt;/p&gt;

&lt;p&gt;As described in the linked article above, patches have already been released for a number of products affected by the Zlib flaw.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Enough Bundling Already!</title>
          <link>http://lowescott.github.io/2005/07/07/enough-bundling-already/</link>
          <pubDate>Thu, 07 Jul 2005 18:09:10 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/07/07/enough-bundling-already/</guid>
          <description>&lt;p&gt;It&amp;rsquo;s bad enough that &lt;a href=&#34;http://www.microsoft.com/&#34;&gt;Microsoft&lt;/a&gt; bundles Internet Explorer and Windows Media Player with every copy of Windows, and then integrates them so deeply that a flaw in one of these applications can compromise the entire system. But bundling adware/spyware?&lt;/p&gt;

&lt;p&gt;First, there was &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1833611,00.asp&#34;&gt;this rumor&lt;/a&gt; about Microsoft acquiring Claria, the company that distributes the Gator ad-serving software. It was just a rumor, and one that not very many people took seriously. But now, there&amp;rsquo;s &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1834607,00.asp&#34;&gt;this news&lt;/a&gt; that Microsoft&amp;rsquo;s anti-spyware program has lowered the rating on Claria&amp;rsquo;s software and changed the default action to &amp;ldquo;Ignore.&amp;rdquo;&lt;/p&gt;

&lt;p&gt;So what does this mean? In reality, nothing. It may have been just an oversight, or it may be that Claria has reached some sort of monetary agreement with Microsoft. In the meantime, I would recommend (as I have in the past) using multiple anti-spyware applications to protect yourself.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Watch Out, IE Users</title>
          <link>http://lowescott.github.io/2005/07/01/watch-out-ie-users/</link>
          <pubDate>Fri, 01 Jul 2005 17:32:09 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/07/01/watch-out-ie-users/</guid>
          <description>&lt;p&gt;A couple of articles are highlighting a recently uncovered security flaw in Microsoft Internet Explorer&amp;ndash;&lt;a href=&#34;http://www.eweek.com/article2/0,1759,1833697,00.asp&#34;&gt;this article&lt;/a&gt; from &lt;em&gt;eWeek&lt;/em&gt; and &lt;a href=&#34;http://www.computerworld.com/securitytopics/security/story/0,10801,102924,00.html&#34;&gt;this article&lt;/a&gt; from &lt;em&gt;ComputerWorld&lt;/em&gt;, both of which reference this &lt;a href=&#34;http://www.microsoft.com/technet/security/advisory/903144.mspx&#34;&gt;security advisory&lt;/a&gt; from &lt;a href=&#34;http://www.microsoft.com/&#34;&gt;Microsoft&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The fix is to set the Security Level for the Internet Zone to High, which disables the functionality required for the exploit to work. Unfortunately, it also disables a lot of other things that non-malicious sites use, so this workaround will affect your ordinary browsing experience.&lt;/p&gt;

&lt;p&gt;My recommendation is to switch to &lt;a href=&#34;http://www.mozilla.org/products/firefox/&#34;&gt;Mozilla Firefox&lt;/a&gt;. While Firefox was shown to be vulnerable to a &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1830025,00.asp&#34;&gt;recent spoofing flaw&lt;/a&gt; (this flaw also affected IE, Safari, Camino, etc.), it&amp;rsquo;s still better than IE&amp;rsquo;s security record. And, yes, for those of you out there who are yelling at your computer screens right now: I know that you probably believe that Firefox is only more secure because there are fewer people using it. Perhaps that&amp;rsquo;s true, but the end result is that it&amp;rsquo;s more secure. Isn&amp;rsquo;t that what we are seeking to achieve?&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>The Next Big Worm?</title>
          <link>http://lowescott.github.io/2005/06/24/the-next-big-worm/</link>
          <pubDate>Fri, 24 Jun 2005 22:29:09 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/06/24/the-next-big-worm/</guid>
          <description>&lt;p&gt;Everyone remember Blaster? There are concerns that the next big Internet worm is about to surface, based upon a vulnerability revealed by Microsoft in the Windows implementation of Server Message Block, or SMB. Get the details on that patch &lt;a href=&#34;http://www.microsoft.com/technet/security/Bulletin/MS05-011.mspx&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Several articles have been posted recently indicating that traffic patterns have been observed that might indicate an exploit of that vulnerability. &lt;a href=&#34;http://www.computerworld.com/securitytopics/security/story/0,10801,102747,00.html&#34;&gt;This article&lt;/a&gt; indicates that some experts believe the traffic patterns are indicative of a new exploit, but others are not concerned.&lt;/p&gt;

&lt;p&gt;More recent than even that article is &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1831325,00.asp&#34;&gt;this posting&lt;/a&gt;, revealing that an exploit for MS05-011 has actually been discovered and made available on the Internet.&lt;/p&gt;

&lt;p&gt;So is there anything you can do to protect yourself? Most firewalls (network-based and host-based) already block TCP port 445, the port used by SMB. If you know your organization allows SMB across the firewall, then you should be concerned. Make sure your systems are patched properly, and keep your anti-virus up to date. That&amp;rsquo;s about all you can do: just stay vigilant.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Dangerous Stuff</title>
          <link>http://lowescott.github.io/2005/06/21/dangerous-stuff/</link>
          <pubDate>Tue, 21 Jun 2005 13:47:22 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/06/21/dangerous-stuff/</guid>
          <description>&lt;p&gt;The Internet grows more dangerous every day. Why? Well, have a look at this &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1829744,00.asp&#34;&gt;recent eWeek article&lt;/a&gt; and this &lt;a href=&#34;http://www.eweek.com/article2/0,1759,1818369,00.asp&#34;&gt;slightly older eWeek article&lt;/a&gt; and you&amp;rsquo;ll see what I mean.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://en.wikipedia.org/wiki/Spyware/&#34;&gt;Spyware&lt;/a&gt; acting like &lt;a href=&#34;http://en.wikipedia.org/wiki/Root_kit/&#34;&gt;root kits&lt;/a&gt;? &lt;a href=&#34;http://en.wikipedia.org/wiki/Computer_virus/&#34;&gt;Viruses&lt;/a&gt; taking on root kit features and able to hide their processes? This is scary stuff. When one of these malicious programs exploits a vulnerability in your web browser, you could get infected and not even know it. And if that application starts using I/O blocking to hide its processes and NTFS data streams to hide files inside other (legitimate) files, you&amp;rsquo;re really in trouble.&lt;/p&gt;

&lt;p&gt;I know that &lt;a href=&#34;http://www.apple.com/macosx/&#34;&gt;Mac OS X&lt;/a&gt; may only be more secure than &lt;a href=&#34;http://www.microsoft.com/windows/&#34;&gt;Microsoft Windows&lt;/a&gt; because not as many people use it, but the end result is the same. If you use Windows, at least protect yourself&amp;ndash;don&amp;rsquo;t use Internet Explorer (use &lt;a href=&#34;www.mozilla.org/products/firefox/&#34;&gt;Firefox&lt;/a&gt;), stay up to date on patches (visit Windows Update regularly), use an anti-virus application (and keep it updated as well), and use a good anti-spyware program (there are several, take your pick). You&amp;rsquo;ll be glad you did.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>New del.icio.us Links</title>
          <link>http://lowescott.github.io/2005/06/14/new-delicious-links/</link>
          <pubDate>Tue, 14 Jun 2005 00:42:41 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/06/14/new-delicious-links/</guid>
          <description>&lt;p&gt;I&amp;rsquo;ve added a couple new links to &lt;a href=&#34;http://del.icio.us/slowe/&#34;&gt;my del.icio.us&lt;/a&gt; bookmarks. Most notably, I&amp;rsquo;ve added an entry for a recent article on &lt;a href=&#34;http://www.onlamp.com/&#34;&gt;ONLamp.com&lt;/a&gt;, a site hosted by the &lt;a href=&#34;http://www.oreillynet.com/&#34;&gt;O&amp;rsquo;Reilly Network&lt;/a&gt;, on &lt;a href=&#34;http://www.modsecurity.org/&#34;&gt;mod_security&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The article, &lt;a href=&#34;http://www.onlamp.com/pub/a/onlamp/2005/06/09/wss_security.html?page=1&#34;&gt;Securing Web Services with mod_security&lt;/a&gt;, is a great introduction to an &lt;a href=&#34;http://httpd.apache.org/&#34;&gt;Apache&lt;/a&gt; module that I&amp;rsquo;ve known about and used for a while now. Similar to &lt;a href=&#34;http://www.microsoft.com/technet/security/tools/urlscan.mspx&#34;&gt;URLScan&lt;/a&gt; for IIS 5.0, mod_security serves to block malicious URLs and invalid requests, even within encrypted HTTPS sessions. As such, it acts as the perfect complement to firewalls and intrusion detection/prevention systems (both network-based and host-based), which typically operate at lower layers of the networking stack.&lt;/p&gt;

&lt;p&gt;If you use Apache, I urge you to evaluate and deploy mod_security to enhance your web server&amp;rsquo;s security.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Perdition Working Now</title>
          <link>http://lowescott.github.io/2005/05/15/perdition-working-now/</link>
          <pubDate>Sun, 15 May 2005 16:31:02 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/05/15/perdition-working-now/</guid>
          <description>&lt;p&gt;I finally managed to get &lt;a href=&#34;http://www.vergenet.net/linux/perdition/&#34;&gt;Perdition&lt;/a&gt; working. Still unable to confirm if &lt;a href=&#34;http://www.apple.com/macosx/&#34;&gt;Mac OS X&amp;rsquo;s&lt;/a&gt; Mail.app supports STARTTLS (my experience thus far says No), I had to resort to using &lt;a href=&#34;http://stunnel.mirt.net/index.html&#34;&gt;Stunnel&lt;/a&gt; to wrap IMAP inside an SSL tunnel, then forward the IMAP traffic to Perdition on the same host. The Perdition proxy then passes the traffic to the back-end mail server. It&amp;rsquo;s not the solution that I really wanted, but it will do for now. At least the &lt;a href=&#34;http://www.microsoft.com/exchange/&#34;&gt;Exchange Server 2003&lt;/a&gt; IMAP server isn&amp;rsquo;t exposed directly to external networks.&lt;/p&gt;

&lt;p&gt;On a slightly related note, the &lt;a href=&#34;http://www.slipstick.com/&#34;&gt;Slipstick Systems&lt;/a&gt; web site has a link to an IMAP proxy server that implements STARTTLS as a workaround for Exchange&amp;rsquo;s lack of native support for STARTTLS. The IMAP proxy can be found at &lt;a href=&#34;http://www.slipstick.com/files/imapproxysvc.zip&#34;&gt;http://www.slipstick.com/files/imapproxysvc.zip&lt;/a&gt;. So, if you have an IMAP4 client that supports STARTTLS and want to connect it to Exchange, you can use this IMAP proxy. At least, until &lt;a href=&#34;http://www.microsoft.com/&#34;&gt;Microsoft&lt;/a&gt; puts STARTTLS support into Exchange directly.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Nonstandard Implementations</title>
          <link>http://lowescott.github.io/2005/05/14/nonstandard-implementations/</link>
          <pubDate>Sat, 14 May 2005 22:24:04 &#43;0000</pubDate>
          <author>Scott Lowe</author>
          <guid>http://lowescott.github.io/2005/05/14/nonstandard-implementations/</guid>
          <description>&lt;p&gt;In my experiments with &lt;a href=&#34;http://www.vergenet.net/linux/perdition/&#34;&gt;Perdition&lt;/a&gt;, I learned a couple of very interesting facts. First, the IMAP4 implementation on &lt;a href=&#34;http://www.microsoft.com/exchange/&#34;&gt;Exchange Server 2003&lt;/a&gt; does not support the STARTTLS command, as described in &lt;a href=&#34;http://www.networksorcery.com/enp/rfc/rfc2595.txt&#34;&gt;RFC 2595&lt;/a&gt; and re-affirmed in &lt;a href=&#34;http://www.networksorcery.com/enp/rfc/rfc3501.txt&#34;&gt;RFC 3501&lt;/a&gt;. Instead, Exchange expects an SSL session to be established immediately, and then IMAP is spoken. This is similar to the &amp;ldquo;smtpd_tls_wrappermode&amp;rdquo; directive that &lt;a href=&#34;http://www.postfix.org/&#34;&gt;Postfix&lt;/a&gt; supports.&lt;/p&gt;

&lt;p&gt;Second, it appears that the &lt;a href=&#34;http://www.apple.com/macosx/&#34;&gt;Mac OS X&lt;/a&gt; Mail application (commonly referred to as Mail.app) also uses this IMAP-over-SSL approach, since I&amp;rsquo;ve been using Mail.app to connect to Exchange using IMAP with SSL for quite some time. I&amp;rsquo;m trying to confirm that now, but having precious little luck finding any definitive information one way or the other. If anyone knows for certain, please let me know. I&amp;rsquo;m going to keep searching.&lt;/p&gt;

&lt;p&gt;This is one of those things that just makes me crazy.&lt;/p&gt;
</description>
        </item>
      
    

  </channel>
</rss>
